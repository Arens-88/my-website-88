<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>亚马逊多平台数据整合报表工具</title>
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/antd@5.12.8/dist/reset.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="static/js/chart_config.js"></script>
</head>
<body>
    <div id="app">
        <!-- 登录界面 -->
        <div id="login-container" class="login-container" v-show="!isAuthenticated">
            <div class="login-box">
                <h2>亚马逊多平台数据整合报表工具</h2>
                <div class="login-form">
                    <div class="form-group">
                        <label for="username">用户名</label>
                        <input type="text" id="username" placeholder="请输入用户名" value="admin">
                    </div>
                    <div class="form-group">
                        <label for="password">密码</label>
                        <input type="password" id="password" placeholder="请输入密码" value="password">
                    </div>
                    <button id="login-btn" class="btn-primary">登录</button>
                    <div id="login-error" class="error-message"></div>
                </div>
            </div>
        </div>

        <!-- 主界面 -->
        <div id="main-container" v-show="isAuthenticated" style="display: none;">
            <!-- 顶部导航栏 -->
            <header class="navbar">
                <div class="navbar-left">
                    <h1>亚马逊多平台数据整合报表工具</h1>
                </div>
                <div class="navbar-right">
                    <span class="current-time"></span>
                    <button id="logout-btn" class="btn-secondary">登出</button>
                </div>
            </header>

            <!-- 侧边菜单栏 -->
            <div class="sidebar">
                <ul class="menu">
                    <li class="menu-item active" data-page="dashboard">
                        <span class="menu-icon">📊</span>
                        <span class="menu-text">数据概览</span>
                    </li>
                    <li class="menu-item" data-page="stores">
                        <span class="menu-icon">🏪</span>
                        <span class="menu-text">店铺管理</span>
                    </li>
                    <li class="menu-item" data-page="sync">
                        <span class="menu-icon">🔄</span>
                        <span class="menu-text">数据同步</span>
                    </li>
                    <li class="menu-item" data-page="costs">
                        <span class="menu-icon">💰</span>
                        <span class="menu-text">成本管理</span>
                    </li>
                    <li class="menu-item" data-page="reports">
                        <span class="menu-icon">📈</span>
                        <span class="menu-text">报表中心</span>
                    </li>
                    <li class="menu-item" data-page="backup">
                        <span class="menu-icon">💾</span>
                        <span class="menu-text">数据备份</span>
                    </li>
                    <li class="menu-item" data-page="config">
                        <span class="menu-icon">⚙️</span>
                        <span class="menu-text">系统配置</span>
                    </li>
                </ul>
            </div>

            <!-- 主内容区域 -->
            <main class="content">
                <!-- 数据概览页面 -->
                <div id="dashboard-page" class="page">
                    <div class="page-header">
                        <h2>数据概览</h2>
                        <div class="header-actions">
                            <select id="store-selector">
                                <option value="">所有店铺</option>
                            </select>
                            <div class="date-range">
                                <input type="date" id="dashboard-start-date">
                                <span>至</span>
                                <input type="date" id="dashboard-end-date">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 核心指标卡片 -->
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-icon">💰</div>
                            <div class="metric-content">
                                <div class="metric-value" id="total-sales">¥0.00</div>
                                <div class="metric-label">总销售额</div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">📊</div>
                            <div class="metric-content">
                                <div class="metric-value" id="total-profit">¥0.00</div>
                                <div class="metric-label">总净利润</div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">📈</div>
                            <div class="metric-content">
                                <div class="metric-value" id="profit-rate">0.00%</div>
                                <div class="metric-label">净利润率</div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-icon">📦</div>
                            <div class="metric-content">
                                <div class="metric-value" id="total-orders">0</div>
                                <div class="metric-label">订单总量</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 图表区域 -->
                    <div class="charts-container">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>销售额趋势</h3>
                                <div class="chart-controls">
                                    <select id="sales-chart-type" class="chart-type-selector">
                                        <option value="line">折线图</option>
                                        <option value="bar">柱状图</option>
                                    </select>
                                </div>
                            </div>
                            <div id="sales-chart" class="chart responsive-chart"></div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>TOP 5 ASIN 销售额</h3>
                                <div class="chart-controls">
                                    <select id="top-asin-chart-type" class="chart-type-selector">
                                        <option value="bar">柱状图</option>
                                        <option value="pie">饼图</option>
                                    </select>
                                </div>
                            </div>
                            <div id="top-asin-chart" class="chart responsive-chart"></div>
                        </div>
                    </div>
                    
                    <!-- 最新订单表格 -->
                    <div class="table-section">
                        <h3>最新整合数据</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ASIN</th>
                                    <th>店铺</th>
                                    <th>日期</th>
                                    <th>销售额</th>
                                    <th>净利润</th>
                                    <th>利润率</th>
                                    <th>订单量</th>
                                </tr>
                            </thead>
                            <tbody id="recent-data-body">
                                <!-- 数据将通过JavaScript动态生成 -->
                                <tr>
                                    <td colspan="7" class="no-data">暂无数据</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 店铺管理页面 -->
                <div id="stores-page" class="page" style="display: none;">
                    <div class="page-header">
                        <h2>店铺管理</h2>
                        <button id="add-store-btn" class="btn-primary">添加店铺</button>
                    </div>
                    
                    <div class="table-section">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>店铺名称</th>
                                    <th>国家</th>
                                    <th>Merchant ID</th>
                                    <th>Marketplace ID</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="stores-table-body">
                                <tr>
                                    <td colspan="6" class="no-data">暂无店铺数据</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 数据同步页面 -->
                <div id="sync-page" class="page" style="display: none;">
                    <div class="page-header">
                        <h2>数据同步</h2>
                        <div class="header-actions">
                            <select id="sync-store-selector">
                                <option value="">所有店铺</option>
                            </select>
                            <input type="date" id="sync-date">
                            <button id="manual-sync-btn" class="btn-primary">立即同步</button>
                        </div>
                    </div>
                    
                    <div class="sync-info">
                        <div class="sync-status">
                            <h3>同步状态</h3>
                            <div class="status-item">
                                <span class="status-label">调度器状态:</span>
                                <span id="scheduler-status" class="status-value">未知</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">下次同步时间:</span>
                                <span id="next-sync-time" class="status-value">--:--</span>
                            </div>
                            <div class="status-actions">
                                <button id="start-scheduler-btn" class="btn-secondary">启动调度器</button>
                                <button id="stop-scheduler-btn" class="btn-secondary">停止调度器</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-section">
                        <h3>同步日志</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>时间</th>
                                    <th>类型</th>
                                    <th>店铺</th>
                                    <th>目标日期</th>
                                    <th>状态</th>
                                    <th>详情</th>
                                </tr>
                            </thead>
                            <tbody id="sync-logs-body">
                                <tr>
                                    <td colspan="6" class="no-data">暂无同步日志</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 成本管理页面 -->
                <div id="costs-page" class="page" style="display: none;">
                    <div class="page-header">
                        <h2>成本管理</h2>
                    </div>
                    
                    <div class="cost-tabs">
                        <button class="tab-btn active" data-tab="upload">文件上传</button>
                        <button class="tab-btn" data-tab="manual">手动录入</button>
                    </div>
                    
                    <!-- 文件上传标签页 -->
                    <div id="upload-tab" class="tab-content">
                        <div class="upload-section">
                            <div class="upload-area">
                                <input type="file" id="cost-file-input" accept=".xlsx,.xls,.csv" style="display: none;">
                                <div id="drop-area" class="drop-area">
                                    <div class="upload-icon">📁</div>
                                    <p>拖拽文件到此处或 <span class="browse-btn">点击上传</span></p>
                                    <p class="upload-hint">支持 Excel (.xlsx, .xls) 或 CSV 文件</p>
                                </div>
                            </div>
                            <div class="upload-template">
                                <p>下载模板文件：</p>
                                <a href="#" id="download-template">成本数据模板.xlsx</a>
                            </div>
                        </div>
                        <div id="upload-result" class="result-section" style="display: none;"></div>
                    </div>
                    
                    <!-- 手动录入标签页 -->
                    <div id="manual-tab" class="tab-content" style="display: none;">
                        <div class="manual-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="manual-asin">ASIN</label>
                                    <select id="manual-asin"></select>
                                </div>
                                <div class="form-group">
                                    <label for="manual-fee-type">费用类型</label>
                                    <select id="manual-fee-type">
                                        <option value="促销费">促销费</option>
                                        <option value="手续费">手续费</option>
                                        <option value="其他">其他</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="manual-amount">金额</label>
                                    <input type="number" id="manual-amount" min="0" step="0.01" placeholder="请输入金额">
                                </div>
                                <div class="form-group">
                                    <label for="manual-date">日期</label>
                                    <input type="date" id="manual-date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="manual-description">描述（可选）</label>
                                <textarea id="manual-description" rows="3" placeholder="请输入描述信息"></textarea>
                            </div>
                            <button id="submit-cost-btn" class="btn-primary">提交</button>
                        </div>
                        <div id="manual-result" class="result-section" style="display: none;"></div>
                    </div>
                </div>

                <!-- 报表中心页面 -->
                <div id="reports-page" class="page" style="display: none;">
                    <div class="page-header">
                        <h2>报表中心</h2>
                        <button id="generate-all-reports" class="btn-primary">生成所有报表</button>
                    </div>
                    
                    <div class="report-tabs">
                        <button class="tab-btn active" data-tab="profit">ASIN利润报表</button>
                        <button class="tab-btn" data-tab="sales">销量趋势报表</button>
                        <button class="tab-btn" data-tab="inventory">库存健康报表</button>
                    </div>
                    
                    <!-- ASIN利润报表标签页 -->
                    <div id="profit-tab" class="tab-content">
                        <div class="report-filters">
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label for="date-range-start">日期范围</label>
                                    <div class="date-range">
                                        <input type="date" id="date-range-start">
                                        <span>至</span>
                                        <input type="date" id="date-range-end">
                                    </div>
                                </div>
                                <div class="filter-group">
                                    <label for="marketplace">市场</label>
                                    <select id="marketplace">
                                        <option value="">全部</option>
                                        <option value="US">美国</option>
                                        <option value="CA">加拿大</option>
                                        <option value="UK">英国</option>
                                        <option value="DE">德国</option>
                                        <option value="FR">法国</option>
                                        <option value="IT">意大利</option>
                                        <option value="ES">西班牙</option>
                                        <option value="JP">日本</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label for="asin-filter">ASIN</label>
                                    <input type="text" id="asin-filter" placeholder="输入ASIN">
                                </div>
                                <div class="filter-group">
                                    <label for="product-name">产品名称</label>
                                    <input type="text" id="product-name" placeholder="搜索产品名称">
                                </div>
                                <div class="filter-actions">
                                    <button id="apply-filters" class="btn-primary">应用筛选</button>
                                    <button id="reset-filters" class="btn-secondary">重置</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 汇总统计 -->
                        <div class="summary-section">
                            <h3>汇总统计</h3>
                            <div class="summary-grid">
                                <div class="summary-item">
                                    <div id="total-asins" class="summary-value">0</div>
                                    <div class="summary-label">ASIN数量</div>
                                </div>
                                <div class="summary-item">
                                    <div id="total-orders" class="summary-value">0</div>
                                    <div class="summary-label">总订单数</div>
                                </div>
                                <div class="summary-item">
                                    <div id="total-sales" class="summary-value">¥0.00</div>
                                    <div class="summary-label">总销售额</div>
                                </div>
                                <div class="summary-item">
                                    <div id="total-profit" class="summary-value">¥0.00</div>
                                    <div class="summary-label">总净利润</div>
                                </div>
                                <div class="summary-item">
                                    <div id="avg-profit-rate" class="summary-value">0%</div>
                                    <div class="summary-label">平均利润率</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 市场表现图表 -->
                        <div class="charts-container">
                            <div class="chart-card">
                                <h3>各市场销售额与净利润对比</h3>
                                <div id="marketplace-chart" class="chart" style="height: 400px;"></div>
                            </div>
                        </div>
                        
                        <!-- 报表表格 -->
                        <div class="table-section">
                            <div class="table-header">
                                <h3>ASIN利润明细</h3>
                                <div class="table-actions">
                                    <button id="export-profit-report" class="btn-primary">导出报表</button>
                                </div>
                            </div>
                            <table id="profit-report-table" class="data-table">
                                <thead>
                                    <tr>
                                        <th class="sortable-header" data-sort="asin">ASIN <span class="sort-icon"></span></th>
                                        <th class="sortable-header" data-sort="product_name">产品名称 <span class="sort-icon"></span></th>
                                        <th class="sortable-header" data-sort="marketplace">市场 <span class="sort-icon"></span></th>
                                        <th class="sortable-header" data-sort="order_count">订单数 <span class="sort-icon"></span></th>
                                        <th class="sortable-header" data-sort="sales">销售额 <span class="sort-icon"></span></th>
                                        <th class="sortable-header" data-sort="cost">成本 <span class="sort-icon"></span></th>
                                        <th class="sortable-header" data-sort="profit">利润 <span class="sort-icon"></span></th>
                                        <th class="sortable-header" data-sort="profit_rate">利润率 <span class="sort-icon"></span></th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="profit-report-body">
                                    <tr><td colspan="9" class="no-data">暂无数据，请选择筛选条件并点击应用筛选</td></tr>
                                </tbody>
                            </table>
                            
                            <!-- 分页 -->
                            <div class="pagination">
                                <span class="pagination-info">显示 0-0 条，共 0 条</span>
                                <button id="prev-page" disabled>上一页</button>
                                <span id="page-indicator">第 1 页</span>
                                <button id="next-page" disabled>下一页</button>
                                <div class="btn-group">
                                    <label for="page-size">每页显示:</label>
                                    <select id="page-size">
                                        <option value="10">10</option>
                                        <option value="20" selected>20</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 销量趋势报表标签页 -->
                    <div id="sales-tab" class="tab-content" style="display: none;">
                        <div class="report-filters">
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label for="sales-start-date">开始日期</label>
                                    <input type="date" id="sales-start-date">
                                </div>
                                <div class="filter-group">
                                    <label for="sales-end-date">结束日期</label>
                                    <input type="date" id="sales-end-date">
                                </div>
                                <div class="filter-group">
                                    <label for="sales-store-id">店铺</label>
                                    <select id="sales-store-id">
                                        <option value="">全部店铺</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label for="sales-marketplace">市场</label>
                                    <select id="sales-marketplace">
                                        <option value="">全部市场</option>
                                        <option value="US">美国</option>
                                        <option value="UK">英国</option>
                                        <option value="DE">德国</option>
                                        <option value="FR">法国</option>
                                        <option value="IT">意大利</option>
                                        <option value="ES">西班牙</option>
                                        <option value="JP">日本</option>
                                        <option value="CA">加拿大</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label for="sales-asin">ASIN</label>
                                    <input type="text" id="sales-asin" placeholder="输入ASIN（可选）">
                                </div>
                                <div class="filter-group">
                                    <label for="sales-group-by">分组方式</label>
                                    <select id="sales-group-by">
                                        <option value="day">按天</option>
                                        <option value="week">按周</option>
                                        <option value="month">按月</option>
                                    </select>
                                </div>
                                <div class="filter-actions">
                                    <button id="sales-search-btn" class="btn-primary">查询</button>
                                    <button id="sales-export-btn" class="btn-secondary">导出</button>
                                    <button id="sales-reset-btn" class="btn-text">重置</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 汇总统计区域 -->
                        <div class="summary-section" id="sales-summary">
                            <div class="summary-card">
                                <div class="summary-value" id="sales-total-orders">--</div>
                                <div class="summary-label">订单总量</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-value" id="sales-total-sales">¥--</div>
                                <div class="summary-label">销售总额</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-value" id="sales-total-profit">¥--</div>
                                <div class="summary-label">净利润</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-value" id="sales-avg-daily-orders">--</div>
                                <div class="summary-label">日均订单</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-value" id="sales-avg-daily-sales">¥--</div>
                                <div class="summary-label">日均销售额</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-value" id="sales-date-range">--</div>
                                <div class="summary-label">日期范围</div>
                            </div>
                        </div>
                        
                        <!-- 异常标注展示区域 -->
                        <div class="anomalies-section" id="sales-anomalies">
                            <h3>异常数据标注</h3>
                            <div class="anomalies-list" id="anomalies-list">
                                <div class="no-data">暂无异常数据</div>
                            </div>
                        </div>
                        
                        <!-- 销量趋势图表 -->
                        <div class="chart-section">
                            <h3>销量趋势图</h3>
                            <div id="sales-trend-chart" class="chart" style="height: 400px;"></div>
                        </div>
                        
                        <!-- 产品对比和市场对比图表 -->
                        <div class="charts-container">
                            <div class="chart-card">
                                <h3>TOP 5 产品销售额</h3>
                                <div id="top-products-chart" class="chart" style="height: 300px;"></div>
                            </div>
                            <div class="chart-card">
                                <h3>市场销售占比</h3>
                                <div id="marketplace-comparison-chart" class="chart" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 库存健康报表标签页 -->
                    <div id="inventory-tab" class="tab-content" style="display: none;">
                        <div class="report-filters">
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label for="inventory-store-selector">店铺</label>
                                    <select id="inventory-store-selector">
                                        <option value="">所有店铺</option>
                                    </select>
                                </div>
                                <button id="inventory-search-btn" class="btn-primary">查询</button>
                                <button id="inventory-export-btn" class="btn-secondary">导出</button>
                            </div>
                        </div>
                        <div class="table-section">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>状态</th>
                                        <th>ASIN</th>
                                        <th>店铺</th>
                                        <th>在库量</th>
                                        <th>在途量</th>
                                        <th>30天销量</th>
                                        <th>库存周转率</th>
                                        <th>库存覆盖天数</th>
                                    </tr>
                                </thead>
                                <tbody id="inventory-table-body">
                                    <tr>
                                        <td colspan="8" class="no-data">暂无数据</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 数据备份页面 -->
                <div id="backup-page" class="page" style="display: none;">
                    <div class="page-header">
                        <h2>数据备份</h2>
                        <button id="create-backup-btn" class="btn-primary">创建备份</button>
                    </div>
                    
                    <div class="backup-section">
                        <div class="backup-settings">
                            <h3>备份设置</h3>
                            <div class="form-group">
                                <label for="backup-days-to-keep">保留天数</label>
                                <input type="number" id="backup-days-to-keep" min="1" max="365" value="30">
                                <span class="hint">超过保留天数的备份将自动删除</span>
                            </div>
                            <button id="cleanup-backup-btn" class="btn-secondary">清理旧备份</button>
                        </div>
                    </div>
                    
                    <div class="table-section">
                        <h3>备份列表</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>备份文件</th>
                                    <th>大小</th>
                                    <th>创建时间</th>
                                    <th>描述</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="backup-list-body">
                                <tr>
                                    <td colspan="5" class="no-data">暂无备份</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 系统配置页面 -->
                <div id="config-page" class="page" style="display: none;">
                    <div class="page-header">
                        <h2>系统配置</h2>
                    </div>
                    
                    <div class="config-tabs">
                        <button class="tab-btn active" data-tab="email">邮件配置</button>
                        <button class="tab-btn" data-tab="wechat">微信配置</button>
                        <button class="tab-btn" data-tab="sync">同步配置</button>
                        <button class="tab-btn" data-tab="reports">基础报表配置</button>
                        <button class="tab-btn" data-tab="report-config">高级报表配置</button>
                    </div>
                    
                    <!-- 邮件配置标签页 -->
                    <div id="email-tab" class="tab-content">
                        <form id="email-config-form" class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="smtp_server">SMTP服务器</label>
                                    <input type="text" id="smtp_server" placeholder="smtp.example.com">
                                </div>
                                <div class="form-group">
                                    <label for="smtp_port">SMTP端口</label>
                                    <input type="number" id="smtp_port" value="587">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="smtp_username">SMTP用户名</label>
                                    <input type="text" id="smtp_username" placeholder="your-email@example.com">
                                </div>
                                <div class="form-group">
                                    <label for="smtp_password">SMTP密码</label>
                                    <input type="password" id="smtp_password" placeholder="password">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="sender_email">发件人邮箱</label>
                                    <input type="email" id="sender_email" placeholder="your-email@example.com">
                                </div>
                                <div class="form-group">
                                    <label for="email_recipients">收件人邮箱</label>
                                    <input type="text" id="email_recipients" placeholder="多个邮箱用逗号分隔">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="smtp_use_tls" checked>
                                        使用TLS加密
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable_email_push">
                                        启用邮件推送
                                    </label>
                                </div>
                            </div>
                        <button type="submit" class="btn-primary">保存配置</button>
                    </form>
                </div>
                
                <!-- 报表配置标签页 -->
                <div id="reports-tab" class="tab-content" style="display: none;">
                    <div class="reports-config-section">
                        <h3>报表数据源配置</h3>
                        <form id="reports-config-form" class="config-form">
                            <div class="config-group">
                                <h4>ASIN利润报表配置</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="profit-include-ad-costs" checked>
                                            包含广告费用
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="profit-include-promotions" checked>
                                            包含促销费用
                                        </label>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="profit-currency-format">货币格式</label>
                                        <select id="profit-currency-format">
                                            <option value="CNY">人民币 (¥)</option>
                                            <option value="USD">美元 ($)</option>
                                            <option value="EUR">欧元 (€)</option>
                                            <option value="GBP">英镑 (£)</option>
                                            <option value="JPY">日元 (¥)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="profit-decimal-places">小数位数</label>
                                        <input type="number" id="profit-decimal-places" min="0" max="4" value="2">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="config-group">
                                <h4>销量趋势报表配置</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="trend-default-group">默认分组方式</label>
                                        <select id="trend-default-group">
                                            <option value="day">按天</option>
                                            <option value="week">按周</option>
                                            <option value="month">按月</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="trend-forecast-days">预测天数</label>
                                        <input type="number" id="trend-forecast-days" min="0" max="30" value="7">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="trend-show-anomalies" checked>
                                            显示异常数据标注
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="trend-show-forecast" checked>
                                            显示销量预测
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="config-group">
                                <h4>库存健康报表配置</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="inventory-healthy-days">健康库存天数</label>
                                        <input type="number" id="inventory-healthy-days" min="7" max="90" value="30">
                                    </div>
                                    <div class="form-group">
                                        <label for="inventory-warning-days">库存预警天数</label>
                                        <input type="number" id="inventory-warning-days" min="1" max="30" value="14">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="inventory-low-threshold">低库存阈值</label>
                                        <input type="number" id="inventory-low-threshold" min="1" max="100" value="10">
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="inventory-group-by-store" checked>
                                            按店铺分组显示
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="config-group">
                                <h4>共享链接配置</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="share-default-expiry">默认有效期（天）</label>
                                        <input type="number" id="share-default-expiry" min="1" max="365" value="7">
                                    </div>
                                    <div class="form-group">
                                        <label for="share-max-expiry">最大有效期（天）</label>
                                        <input type="number" id="share-max-expiry" min="7" max="365" value="30">
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn-primary">保存报表配置</button>
                        </form>
                    </div>
                    
                    <!-- 报表数据源管理 -->
                    <div class="reports-config-section">
                        <h3>数据源管理</h3>
                        <div class="data-source-tabs">
                            <button class="data-source-tab-btn active" data-source-tab="primary">主数据源</button>
                            <button class="data-source-tab-btn" data-source-tab="secondary">辅助数据源</button>
                            <button class="data-source-tab-btn" data-source-tab="custom">自定义指标</button>
                        </div>
                        
                        <div id="primary-tab" class="data-source-tab-content">
                            <div class="data-source-list">
                                <div class="data-source-item">
                                    <div class="data-source-header">
                                        <span class="data-source-name">亚马逊销售数据</span>
                                        <span class="data-source-status active">已启用</span>
                                    </div>
                                    <div class="data-source-details">
                                        <p>来源: 亚马逊SP-API</p>
                                        <p>更新频率: 每日自动同步</p>
                                    </div>
                                </div>
                                <div class="data-source-item">
                                    <div class="data-source-header">
                                        <span class="data-source-name">亚马逊库存数据</span>
                                        <span class="data-source-status active">已启用</span>
                                    </div>
                                    <div class="data-source-details">
                                        <p>来源: 亚马逊SP-API</p>
                                        <p>更新频率: 每日自动同步</p>
                                    </div>
                                </div>
                                <div class="data-source-item">
                                    <div class="data-source-header">
                                        <span class="data-source-name">ERP成本数据</span>
                                        <span class="data-source-status active">已启用</span>
                                    </div>
                                    <div class="data-source-details">
                                        <p>来源: 文件上传/手动录入</p>
                                        <p>更新频率: 手动更新</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="secondary-tab" class="data-source-tab-content" style="display: none;">
                            <div class="data-source-list">
                                <div class="data-source-item">
                                    <div class="data-source-header">
                                        <span class="data-source-name">亚马逊广告数据</span>
                                        <span class="data-source-status active">已启用</span>
                                    </div>
                                    <div class="data-source-details">
                                        <p>来源: 亚马逊SP-API</p>
                                        <p>更新频率: 每日自动同步</p>
                                    </div>
                                </div>
                                <div class="data-source-item">
                                    <div class="data-source-header">
                                        <span class="data-source-name">手动录入成本</span>
                                        <span class="data-source-status active">已启用</span>
                                    </div>
                                    <div class="data-source-details">
                                        <p>来源: 手动录入表单</p>
                                        <p>更新频率: 手动更新</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="custom-tab" class="data-source-tab-content" style="display: none;">
                            <div class="custom-metrics-section">
                                <h4>自定义计算指标</h4>
                                <div class="custom-metric-list">
                                    <!-- 已有的自定义指标 -->
                                </div>
                                <button id="add-custom-metric-btn" class="btn-secondary">添加自定义指标</button>
                            </div>
                        </div>
                    </div>
                </div>
                    
                    <!-- 高级报表配置标签页 -->
                    <div id="report-config" class="tab-content" style="display: none;">
                        <div class="report-config-section">
                            <h3>报表模板配置</h3>
                            <div class="report-templates">
                                <div class="template-item">
                                    <div class="template-header">
                                        <h4>标准利润报表</h4>
                                        <div class="template-actions">
                                            <button class="btn-secondary btn-small" onclick="editReportTemplate('standard_profit')">编辑</button>
                                            <button class="btn-secondary btn-small" onclick="duplicateReportTemplate('standard_profit')">复制</button>
                                        </div>
                                    </div>
                                    <div class="template-details">
                                        <p><strong>描述：</strong>包含销售额、成本、利润等核心指标的标准利润报表</p>
                                        <p><strong>数据源：</strong>亚马逊销售数据、ERP成本数据</p>
                                        <p><strong>自动生成：</strong>每日更新</p>
                                    </div>
                                </div>
                                <div class="template-item">
                                    <div class="template-header">
                                        <h4>库存健康报表</h4>
                                        <div class="template-actions">
                                            <button class="btn-secondary btn-small" onclick="editReportTemplate('inventory_health')">编辑</button>
                                            <button class="btn-secondary btn-small" onclick="duplicateReportTemplate('inventory_health')">复制</button>
                                        </div>
                                    </div>
                                    <div class="template-details">
                                        <p><strong>描述：</strong>监控库存状态、周转率和库存健康度的报表</p>
                                        <p><strong>数据源：</strong>亚马逊库存数据、销售趋势数据</p>
                                        <p><strong>自动生成：</strong>每日更新</p>
                                    </div>
                                </div>
                                <div class="template-item">
                                    <div class="template-header">
                                        <h4>自定义报表</h4>
                                        <div class="template-actions">
                                            <button class="btn-secondary btn-small" onclick="createNewReportTemplate()">创建</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="report-config-section">
                            <h3>数据源配置</h3>
                            <div class="data-source-configs">
                                <div class="data-source-config">
                                    <h4>销售数据配置</h4>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="include_sales_data" checked>
                                            启用销售数据
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label for="sales_data_refresh_interval">数据刷新间隔（天）</label>
                                        <input type="number" id="sales_data_refresh_interval" min="1" max="30" value="1">
                                    </div>
                                </div>
                                
                                <div class="data-source-config">
                                    <h4>库存数据配置</h4>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="include_inventory_data" checked>
                                            启用库存数据
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label for="inventory_data_refresh_interval">数据刷新间隔（小时）</label>
                                        <input type="number" id="inventory_data_refresh_interval" min="1" max="24" value="6">
                                    </div>
                                </div>
                                
                                <div class="data-source-config">
                                    <h4>成本数据配置</h4>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="include_cost_data" checked>
                                            启用成本数据
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label for="cost_data_source">成本数据来源</label>
                                        <select id="cost_data_source">
                                            <option value="erp">ERP导入</option>
                                            <option value="manual">手动录入</option>
                                            <option value="both">两者结合</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="report-config-section">
                            <h3>报表逻辑配置</h3>
                            <div class="report-logic-config">
                                <div class="form-group">
                                    <label for="profit_calculation_method">利润计算方法</label>
                                    <select id="profit_calculation_method">
                                        <option value="gross">毛利润（收入-成本）</option>
                                        <option value="net">净利润（收入-所有支出）</option>
                                        <option value="custom">自定义公式</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="custom_profit_formula">自定义利润公式</label>
                                    <input type="text" id="custom_profit_formula" placeholder="例如：revenue - cost_of_goods - shipping_fees - ad_costs" disabled>
                                    <div class="hint">可用变量：revenue, cost_of_goods, shipping_fees, ad_costs, storage_fees, other_fees</div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="include_adjustments" checked>
                                        包含促销和折扣调整
                                    </label>
                                </div>
                                
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="apply_exchange_rate" checked>
                                        应用汇率转换（多币种）
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="report-config-section">
                            <h3>可视化配置</h3>
                            <div class="visualization-config">
                                <div class="form-group">
                                    <label for="default_chart_type">默认图表类型</label>
                                    <select id="default_chart_type">
                                        <option value="bar">柱状图</option>
                                        <option value="line">折线图</option>
                                        <option value="pie">饼图</option>
                                        <option value="table">数据表格</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="show_comparison" checked>
                                        显示环比数据
                                    </label>
                                </div>
                                
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="show_trend_lines" checked>
                                        显示趋势线
                                    </label>
                                </div>
                                
                                <div class="form-group">
                                    <label for="decimal_precision">数值精度（小数位）</label>
                                    <input type="number" id="decimal_precision" min="0" max="4" value="2">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn-primary" onclick="saveReportConfigurations()">保存所有配置</button>
                            <button type="button" class="btn-secondary" onclick="resetReportConfigurations()">重置为默认</button>
                        </div>
                    </div>
                    
                    <!-- 微信配置标签页 -->
                    <div id="wechat-tab" class="tab-content" style="display: none;">
                        <form id="wechat-config-form" class="config-form">
                            <div class="form-group">
                                <label for="wechat_webhook_url">企业微信机器人Webhook</label>
                                <input type="text" id="wechat_webhook_url" placeholder="https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=...">
                                <div class="hint">获取方式：在企业微信群中添加机器人，复制Webhook地址</div>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="enable_wechat_push">
                                    启用企业微信推送
                                </label>
                            </div>
                            <div class="form-group">
                                <label for="push_hour">推送时间（小时）</label>
                                <input type="number" id="push_hour" min="0" max="23" value="8">
                                <span>时</span>
                                <input type="number" id="push_minute" min="0" max="59" value="0">
                                <span>分</span>
                                <div class="hint">默认每日8:00发送报表推送</div>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">保存配置</button>
                                <button type="button" class="btn-secondary" onclick="testWechatPush()">测试推送</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- 同步配置标签页 -->
                    <div id="sync-tab" class="tab-content" style="display: none;">
                        <form id="sync-config-form" class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="sync_hour">同步时间（小时）</label>
                                    <input type="number" id="sync_hour" min="0" max="23" value="2">
                                </div>
                                <div class="form-group">
                                    <label for="sync_minute">同步时间（分钟）</label>
                                    <input type="number" id="sync_minute" min="0" max="59" value="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="enable_scheduler">
                                    启用自动同步
                                </label>
                            </div>
                            <button type="submit" class="btn-primary">保存配置</button>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- 模态框 -->
    <div id="modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">模态框标题</h3>
                <button id="close-modal" class="close-modal">×</button>
            </div>
            <div id="modal-body" class="modal-body">
                <!-- 模态框内容将动态生成 -->
            </div>
            <div class="modal-footer">
                <button id="modal-cancel" class="btn-secondary">取消</button>
                <button id="modal-confirm" class="btn-primary">确认</button>
            </div>
        </div>
    </div>

    <!-- 消息提示 -->
    <div id="message" class="message" style="display: none;">
        <div id="message-content" class="message-content"></div>
    </div>

    <script src="static/js/app.js"></script>
</body>
</html>